<!doctype html>
<html class="lazyload" lang="en">
    <head>
        <title>README · Obullo Php7 Router.</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                <link rel="icon" type="image/png" href="/icon.png">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Share:400|Jaldi:400,700|Fira+Mono:400,700">
        <link rel="stylesheet" href="/assets/base.css">
        <link rel="stylesheet" href="/assets/lindoc.css">
                <script>
            // Parent Elements - e.P("body") - https://gist.github.com/moqmar/0995cf6595201f7a062fb173cb4ab938
            (function(E){E.matches||(E.matches=E.matchesSelector||E.msMatchesSelector||E.webkitMatchesSelector)})(Element.prototype)
            Element.prototype.P=function(s){var e=this
            if(!s||typeof s=="number")for(var i=0;i<(s||1);i++)e=e?e.parentElement:e
            else if(typeof s=="string")while(e&&!e.matches(s))e=e.parentElement
            else while(e&&e!=s)e=e.parentElement
            return e}
        </script>
    </head>
    <body>
        <header>
            <div class="nav">
                <div style="text-align: left;"><a href="#" style="font-weight:bold;font-size:54px;">Documentation</a> </div>
            </div>
            <div class="language">
                <input type="checkbox" id="language-select">
                <label for="language-select"><img src="/assets/flags/en.png"></label>
                <div class="language-select-popup" data-default-language="en">
                    <a href="/"><img src="/assets/flags/en.png"></a>
                    <a href="/tr/"><img src="/assets/flags/tr.png"></a>
                </div>
                <script>
                    document.getElementById("language-select").checked = false;
                    window.addEventListener("click", function(event) {
                        if (!event.target.P(".language")) document.getElementById("language-select").checked = false;
                    })
                </script>
            </div>
            <nav class="breadcrumbs">
                
            </nav>
        </header>

        <main>
            <aside class="toc"><ul></ul></aside>
            <article>

<!-- CONTENT START -->
<h1 id="php7-router">Php7 Router</h1>
<p><a href="https://travis-ci.org/obullo/Router"><img src="https://travis-ci.org/obullo/Router.svg?branch=master" alt="Build Status" /></a>
<a href="LICENSE.md"><img src="https://img.shields.io/badge/license-MIT-brightgreen.svg" alt="Software License" /></a>
<a href="https://packagist.org/packages/obullo/router"><img src="https://img.shields.io/packagist/dt/obullo/router.svg" alt="Total Downloads" /></a></p>
<blockquote>
<p>Obullo Php7 router Django Url Dispatcher kütühanesinden ilham alınarak geliştirilmiştir ve anlaşılabilir olmayı hedefler.</p>
</blockquote>
<h2 id="ykleme">Yükleme</h2>
<p>Via Composer</p>
<pre><code class="language-bash">$ composer require obullo/router</code></pre>
<h2 id="host-configurasyonu">Host configurasyonu</h2>
<p><a href="configuration.html">CONFIGURATION.md</a></p>
<h2 id="gereksinimler">Gereksinimler</h2>
<p>Bu versiyon aşağıdaki PHP sürümleri tarafından destekleniyor.</p>
<ul>
<li>7.0</li>
<li>7.1</li>
<li>7.2</li>
</ul>
<h2 id="test">Test</h2>
<pre><code class="language-bash">$ vendor/bin/phpunit</code></pre>
<h2 id="diller">Diller</h2>
<ul>
<li><a href="tr_configuration.html">TR_CONFIGURATION.md</a></li>
<li><a href="tr_readme.html">TR_README.md</a></li>
</ul>
<h2 id="hzl-balang">Hızlı Başlangıç</h2>
<pre><code class="language-php">require '../vendor/autoload.php';

use Obullo\Router\Route;
use Obullo\Router\RequestContext;
use Obullo\Router\RouteCollection;
use Obullo\Router\Router;
use Obullo\Router\Types\{
    StrType,
    IntType
};
$configArray = array(
    'types' =&gt; [
        new IntType('&lt;int:id&gt;'),
        new StrType('&lt;str:name&gt;'),
    ]
);
$config = new Zend\Config\Config($configArray);</code></pre>
<p>Psr7 Request</p>
<pre><code class="language-php">$request = Zend\Diactoros\ServerRequestFactory::fromGlobals();
$context = new RequestContext;
$context-&gt;fromRequest($request);</code></pre>
<p>Route Kolleksiyonu</p>
<pre><code class="language-php">$collection = new RouteCollection($config);
$collection-&gt;setContext($context);
$collection-&gt;add('home', new Route('GET', '/', 'App\Controller\DefaultController::index'));
$collection-&gt;add(
    'dummy',
    new Route('GET', '/dummy/index/&lt;int:id&gt;/&lt;str:name&gt;', 'App\Controller\DummyController::index')
);
$route = $collection-&gt;get('dummy');

echo $route-&gt;getHandler(); //  "App\Controller\DummyController::index"
echo $route-&gt;getMethods()[0]; // GET
echo $route-&gt;getPattern(); //  "/dummy/index/(?\d+)/(?\w+)"</code></pre>
<p>Çözümleme</p>
<pre><code class="language-php">$router = new Router($collection);

if ($route = $router-&gt;matchRequest()) {

    $handler = $route-&gt;getHandler();
    $args = array_merge(array('request' =&gt; $request), $route-&gt;getArguments());

    $response = null;
    if (is_callable($handler)) {
        $exp = explode('::', $handler);
        $class = new $exp[0];
        $method = $exp[1];
        $response = call_user_func_array(array($class, $method), $args);
    }
    if ($response instanceof Psr\Http\Message\ResponseInterface) {
        echo $response-&gt;getBody();  // DummyController::index
    }
}</code></pre>
<p>App\Controller\DummyController sınıfı</p>
<pre><code class="language-php">namespace App\Controller;

use Zend\Diactoros\Response\HtmlResponse;
use Psr\Http\Message\RequestInterface as Request;

class DummyController
{
    public function index(Request $request)
    {
        return new HtmlResponse('DummyController::index');
    }
}</code></pre>
<h2 id="tr-konfigrasyonu">Tür Konfigürasyonu</h2>
<p>Önceden belirlenen tür tanımları route kuralları içerisindeki argümanların daha esnek bir biçimde yönetilmesini sağlar ve güvenliği arttırır.</p>
<pre><code class="language-php">$configArray = array(
    'types' =&gt; [
        new IntType('&lt;int:id&gt;'),
        new StrType('&lt;str:name&gt;'),
        new StrType('&lt;str:word&gt;'),
        new AnyType('&lt;any:any&gt;'),
        new BoolType('&lt;bool:status&gt;'),
        new IntType('&lt;int:page&gt;'),
        new SlugType('&lt;slug:slug&gt;'),
        new SlugType('&lt;slug:slug_&gt;', '(?&lt;%s&gt;[\w-_]+)'), // slug with underscore
    ]
);
$config = new Zend\Config\Config($configArray);</code></pre>
<p>Aşağıda Int türüne ait bir örnek gösteriliyor.</p>
<pre><code>class IntType extends Type
{
    protected $regex = '(?&lt;%s&gt;\d+)';

    /**
     * Php format
     * 
     * @param  number $value 
     * @return int
     */
    public function toPhp($value)
    {
        return (int)$value;
    }

    /**
     * Url format
     * 
     * @param mixed $value
     * @return string
     */
    public function toUrl($value)
    {
        return sprintf('%d', $value);
    }
}</code></pre>
<ul>
<li><code>regex</code> değişkeni içerisindeki <code>%s</code> değeri <code>&lt;int:id&gt;</code> gibi bir türe ilişkin ismin <code>(?&lt;id&gt;\d+)</code> ifadesine dönüştürülmesini sağlar.</li>
<li><code>toPhp</code> metodu gelen argüman türünü php içerisinde kullanılmadan önce belirlenen türe dönüştürür.</li>
<li><code>toUrl</code> metodu UrlGenerator sınıfını kullanarak güvenli url linkleri oluşturmanızı sağlar.</li>
<li>Abstract Type sınıfına genişleyerek kendi türlerinizi de oluşturabilirsiniz.</li>
</ul>
<p>Tanımlı türü bozmanda ön tanımlı bir regex değerini değiştirmek için construct metodu ikinci parametresini kullanabilirsiniz.</p>
<pre><code class="language-php">new SlugType('&lt;slug:slug&gt;');
new SlugType('&lt;slug:slug_&gt;', '(?&lt;%s&gt;[\w-_]+)');  // slug with underscore</code></pre>
<p>Klonlanan ikinci türe ait isim mutlaka değiştirilmelidir. Yukarıdaki örnekte slug türü klonlanarak alt çizgi desteği eklendi. <code>&lt;slug:slug_&gt;</code></p>
<h2 id="ykleyiciler">Yükleyiciler</h2>
<h3 id="yaml-dosya-ykleyicisi">Yaml dosya yükleyicisi</h3>
<h3 id="php-dosya-ykleyicisi">Php dosya yükleyicisi</h3>
<h3 id="route-kolleksiyonu">Route Kolleksiyonu</h3>
<pre><code class="language-php"></code></pre>
<h2 id="pipe-ile-gruplama">Pipe ile gruplama</h2>
<h3 id="yaml-rnei">Yaml örneği</h3>
<h2 id="url-zmleme">Url Çözümleme</h2>
<h3 id="match">Match</h3>
<h3 id="matchrequest">MatchRequest</h3>
<h2 id="koullu-tanmlamalar">Koşullu tanımlamalar</h2>
<h3 id="host">Host</h3>
<h3 id="scheme">Scheme</h3>
<h2 id="stack">Stack</h2>
<h3 id="middleware-eklemek">Middleware eklemek</h3>
<h3 id="middleware-dizisini-almak">Middleware dizisini almak</h3>
<h2 id="url-generator">Url Generator</h2>
<h2 id="yerelletirme">Yerelleştirme</h2>
<!-- CONTENT END -->

            </article>
            <aside class="sidebar">
                <hr>
                <h2>Obullo Components</h2>
                <h3>Links</h3>
                <div class="bulletlink"><a href="http://obullo.com">Homepage</a></div>
                <div class="bulletlink"><a href="http://github.com/obullo/Router">Github Repository</a></div>
                <hr>
                <p></p>
            </aside>
            <footer>
                <hr>

<!-- FOOTER BEGIN -->
© 2018

<!-- FOOTER END -->

            </footer>
        </main>

        <script src="/assets/toc.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/plugins/autoloader/prism-autoloader.min.js"></script>
        <script>Prism.plugins.autoloader.languages_path = "https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/";</script>
        <link rel="stylesheet" href="/assets/prism.css">
        <!-- Livereload -->
        <script>
            document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] +
                    ':35729/livereload.js?snipver=1"></' + 'script>')
        </script>
        <!-- End Livereload -->
    </body>
</html>
